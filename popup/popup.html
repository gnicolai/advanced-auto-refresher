<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=400, initial-scale=1.0">
  <title>Advanced Auto Refresher</title>
  <link rel="stylesheet" href="popup.css">
</head>

<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="logo">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M23 4v6h-6"></path>
          <path d="M1 20v-6h6"></path>
          <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
        </svg>
        <h1>Advanced Auto Refresher</h1>
      </div>
      <div class="header-right">
        <!-- Language Selector -->
        <div id="languageSelector"></div>
        <div class="status-indicator" id="statusIndicator">
          <span class="status-dot"></span>
          <span class="status-text" data-i18n="status.inactive">Disattivo</span>
        </div>
      </div>
    </header>

    <!-- Main Controls -->
    <section class="section">
      <h2 class="section-title" data-i18n="timer.title">Timer Auto-Refresh</h2>

      <div class="control-group">
        <label for="intervalInput" data-i18n="timer.interval">Intervallo (secondi)</label>
        <div class="input-row">
          <input type="number" id="intervalInput" min="1" max="3600" value="30" class="input-field">
          <button id="toggleRefresh" class="btn btn-primary">
            <span class="btn-icon play-icon">‚ñ∂</span>
            <span class="btn-text" data-i18n="timer.start">Avvia</span>
          </button>
        </div>
      </div>

      <!-- Stochastic Mode -->
      <div class="control-group">
        <div class="checkbox-row">
          <input type="checkbox" id="stochasticMode" class="checkbox">
          <label for="stochasticMode" data-i18n="stochastic.mode">Modalit√† stocastica</label>
          <span class="tooltip" data-i18n-tooltip="stochastic.tooltip"
            data-tooltip="Varia casualmente il tempo di refresh per evitare pattern rilevabili">?</span>
        </div>
      </div>

      <div class="stochastic-options" id="stochasticOptions">
        <div class="control-group">
          <label for="minLimit" data-i18n="stochastic.minLimit">Limite minimo (secondi)</label>
          <input type="number" id="minLimit" min="1" max="3600" value="5" class="input-field input-small">
        </div>

        <div class="control-group">
          <label data-i18n="stochastic.distribution">Distribuzione</label>
          <div class="radio-group">
            <label class="radio-label">
              <input type="radio" name="distribution" value="uniform" checked>
              <span class="radio-custom"></span>
              <span data-i18n="stochastic.uniform">Uniforme</span>
              <span class="tooltip" data-i18n-tooltip="stochastic.uniformTooltip"
                data-tooltip="Tempo casuale tra min e (2√ótarget‚àímin)">?</span>
            </label>
            <label class="radio-label">
              <input type="radio" name="distribution" value="gaussian">
              <span class="radio-custom"></span>
              <span data-i18n="stochastic.gaussian">Gaussiana</span>
              <span class="tooltip" data-i18n-tooltip="stochastic.gaussianTooltip"
                data-tooltip="Tempo centrato sul target con variazione naturale">?</span>
            </label>
          </div>
        </div>
      </div>
    </section>

    <!-- Content Watch -->
    <section class="section">
      <h2 class="section-title">
        <span data-i18n="contentWatch.title">Rilevamento Cambiamenti</span>
        <span class="badge badge-new">Alert</span>
      </h2>

      <div class="control-group">
        <div class="checkbox-row">
          <input type="checkbox" id="contentWatchEnabled" class="checkbox">
          <label for="contentWatchEnabled" data-i18n="contentWatch.enable">Monitora contenuto</label>
        </div>
      </div>

      <div class="content-watch-options" id="contentWatchOptions">
        <div class="control-group">
          <label data-i18n="contentWatch.method">Metodo selezione</label>
          <div class="btn-group">
            <button id="pickerModeBtn" class="btn btn-secondary btn-small active">
              <span>üéØ</span> <span data-i18n="contentWatch.select">Seleziona</span>
            </button>
            <button id="advancedModeBtn" class="btn btn-secondary btn-small">
              <span>‚öôÔ∏è</span> <span data-i18n="contentWatch.advanced">Avanzato</span>
            </button>
          </div>
        </div>

        <!-- Picker Mode -->
        <div class="picker-mode" id="pickerMode">
          <button id="startPicker" class="btn btn-accent btn-full" data-i18n="contentWatch.pickElement">
            Clicca per selezionare elemento
          </button>
          <div class="selected-element" id="selectedElement">
            <span class="selected-label" data-i18n="contentWatch.selectedElement">Elemento selezionato:</span>
            <span class="selected-value" id="selectedValue" data-i18n="contentWatch.none">Nessuno</span>
          </div>
        </div>

        <!-- Advanced Mode -->
        <div class="advanced-mode hidden" id="advancedMode">
          <div class="control-group">
            <label for="cssSelector" data-i18n="contentWatch.cssSelector">Selettore CSS</label>
            <input type="text" id="cssSelector" placeholder=".result-count" class="input-field">
          </div>
          <button id="testSelector" class="btn btn-secondary btn-full" data-i18n="contentWatch.testSelector">
            Testa Selettore
          </button>
        </div>

        <div class="current-value-display" id="currentValueDisplay">
          <span class="value-label" data-i18n="contentWatch.currentValue">Valore attuale:</span>
          <span class="value-number" id="currentValue">--</span>
        </div>

        <!-- Alert Mode -->
        <div class="control-group">
          <label for="alertMode" data-i18n="contentWatch.alertMode">Modalit√† allarme</label>
          <select id="alertMode" class="select-field">
            <option value="increase" data-i18n="contentWatch.alertModeIncrease">üìà Aumento</option>
            <option value="decrease" data-i18n="contentWatch.alertModeDecrease">üìâ Diminuzione</option>
            <option value="any" data-i18n="contentWatch.alertModeAny">üîÑ Qualsiasi cambio</option>
            <option value="above" data-i18n="contentWatch.alertModeAbove">‚¨ÜÔ∏è Sopra soglia</option>
            <option value="below" data-i18n="contentWatch.alertModeBelow">‚¨áÔ∏è Sotto soglia</option>
          </select>
        </div>

        <!-- Threshold Input (visible only for threshold modes) -->
        <div class="control-group threshold-group hidden" id="thresholdGroup">
          <label for="thresholdValue" data-i18n="contentWatch.thresholdValue">Valore soglia</label>
          <input type="number" id="thresholdValue" class="input-field" placeholder="0" value="0">
        </div>
      </div>
    </section>

    <!-- Telegram Notifications -->
    <section class="card" id="telegramSection">
      <div class="section-header" data-toggle="telegramOptions">
        <div class="section-title">
          <label class="checkbox-inline" id="telegramToggleLabel">
            <input type="checkbox" id="telegramEnabled">
            <span class="checkmark"></span>
          </label>
          <span class="icon">üì±</span>
          <span data-i18n="telegram.title">Telegram Notifications</span>
        </div>
      </div>

      <div class="telegram-options hidden" id="telegramOptions">
        <!-- How to setup guide (collapsible) -->
        <details class="telegram-howto">
          <summary data-i18n="telegram.howtoTitle">üìñ Come configurare il bot Telegram</summary>
          <div class="howto-content">
            <ol>
              <li data-i18n="telegram.howtoStep1">Apri Telegram e cerca <strong>@BotFather</strong></li>
              <li data-i18n="telegram.howtoStep2">Invia <code>/newbot</code> e segui le istruzioni</li>
              <li data-i18n="telegram.howtoStep3">Copia il <strong>Token</strong> che ricevi</li>
              <li data-i18n="telegram.howtoStep4">Cerca <strong>@userinfobot</strong> e invia un messaggio</li>
              <li data-i18n="telegram.howtoStep5">Copia il tuo <strong>Chat ID</strong> numerico</li>
              <li data-i18n="telegram.howtoStep6">Incolla entrambi qui sotto e premi "Test"</li>
            </ol>
          </div>
        </details>

        <div class="control-group">
          <label for="telegramBotToken" data-i18n="telegram.botToken">Bot Token</label>
          <input type="password" id="telegramBotToken" class="input-field"
            placeholder="123456789:ABCdefGHIjklMNOpqrsTUVwxyz" data-i18n-placeholder="telegram.botTokenPlaceholder">
        </div>

        <div class="control-group">
          <label for="telegramChatId" data-i18n="telegram.chatId">Chat ID</label>
          <input type="text" id="telegramChatId" class="input-field" placeholder="123456789"
            data-i18n-placeholder="telegram.chatIdPlaceholder">
        </div>

        <button id="testTelegram" class="btn btn-secondary btn-full">
          <span>üß™</span>
          <span data-i18n="telegram.testButton">Testa Notifica</span>
        </button>

        <div class="telegram-status hidden" id="telegramStatus"></div>
        <div class="last-status hidden" id="lastNotificationStatus"></div>
      </div>
    </section>

    <!-- Blacklist -->
    <section class="section collapsible">
      <h2 class="section-title clickable" id="blacklistToggle">
        <span data-i18n="lists.title">Blacklist / Whitelist</span>
        <span class="collapse-icon">‚ñº</span>
      </h2>

      <div class="collapsible-content" id="blacklistContent">
        <div class="tabs">
          <button class="tab active" data-tab="blacklist" data-i18n="lists.blacklist">Blacklist</button>
          <button class="tab" data-tab="whitelist" data-i18n="lists.whitelist">Whitelist</button>
        </div>

        <div class="tab-content active" id="blacklistTab">
          <p class="tab-description" data-i18n="lists.blacklistDesc">üö´ Il refresh verr√† saltato su questi URL (es:
            pagine di checkout, login)</p>
          <div class="url-input-row">
            <input type="text" id="blacklistUrl" placeholder="*checkout*" class="input-field"
              data-i18n-placeholder="lists.blacklistPlaceholder">
            <button id="addBlacklist" class="btn btn-secondary btn-icon-only">+</button>
          </div>
          <ul class="url-list" id="blacklistList"></ul>
        </div>

        <div class="tab-content" id="whitelistTab">
          <p class="tab-description" data-i18n="lists.whitelistDesc">‚úÖ Questi URL ignorano la blacklist (ha priorit√†)
          </p>
          <div class="url-input-row">
            <input type="text" id="whitelistUrl" placeholder="*deals*" class="input-field"
              data-i18n-placeholder="lists.whitelistPlaceholder">
            <button id="addWhitelist" class="btn btn-secondary btn-icon-only">+</button>
          </div>
          <ul class="url-list" id="whitelistList"></ul>
        </div>
      </div>
    </section>

    <!-- Audio Alert Control (visible when alert is playing) -->
    <div class="alert-overlay hidden" id="alertOverlay">
      <div class="alert-content">
        <div class="alert-icon">üîî</div>
        <div class="alert-message" data-i18n="alert.newContent">Nuovo contenuto rilevato!</div>
        <button id="stopAlert" class="btn btn-danger btn-full" data-i18n="alert.stopAlarm">
          Ferma Allarme
        </button>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <span class="version">v1.0.0</span>
      <a href="https://giulionicolai.com" target="_blank" class="creator-link" data-i18n="footer.createdBy">Created by
        Giulio Nicolai</a>
      <div class="donate-section">
        <span class="donate-text" data-i18n="footer.donateText">Ti piace l'estensione?</span> ‚òï
        <a href="https://www.paypal.com/donate/?hosted_button_id=RZKA34HTGKGJG" target="_blank" class="donate-btn">
          <span class="donate-icon">‚ù§Ô∏è</span>
          <span data-i18n="footer.donate">Donate</span>
        </a>
      </div>
    </footer>
  </div>

  <script src="i18n.js"></script>
  <script src="popup.js"></script>
</body>

</html>